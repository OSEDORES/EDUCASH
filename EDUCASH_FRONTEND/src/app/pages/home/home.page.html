<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-menu-button color="light"></ion-menu-button>
    </ion-buttons>
    <ion-title class="header-title">EDUCA$H</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="home-content">
  <!-- Tarjeta de resumen principal -->
  <ion-card class="summary-card">
    <ion-card-header>
      <ion-card-subtitle>Balance Actual</ion-card-subtitle>
      <ion-card-title class="balance-amount">{{ saldoTotal | currency:'HNL':'L ' }}</ion-card-title>
    </ion-card-header>
    
    <ion-card-content>
      <div class="summary-grid">
        <div class="summary-item income">
          <ion-icon name="trending-up-outline"></ion-icon>
          <div>
            <p>Ingresos</p>
            <h3>{{ totalIngresos | currency:'HNL':'L ' }}</h3>
          </div>
        </div>
        
        <div class="summary-item expense">
          <ion-icon name="trending-down-outline"></ion-icon>
          <div>
            <p>Gastos</p>
            <h3>{{ totalGastos | currency:'HNL':'L ' }}</h3>
          </div>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Gráfico circular -->
  <ion-card class="chart-card">
    <ion-card-header>
      <ion-card-title>Distribución</ion-card-title>
      <ion-segment [(ngModel)]="chartPeriod" (ionChange)="updateChart()">
        <ion-segment-button value="month">
          <ion-label>Mes</ion-label>
        </ion-segment-button>
        <ion-segment-button value="year">
          <ion-label>Año</ion-label>
        </ion-segment-button>
      </ion-segment>
    </ion-card-header>
    
    <ion-card-content>
      <div class="chart-comparison">
        <!-- Gráfico de proporción gastos/ingresos -->
        <div class="chart-wrapper">
          <canvas #chartContainer class="chart-container"></canvas>
          <div class="chart-center-text">
            <span *ngIf="chartPeriod === 'month'">Mes</span>
            <span *ngIf="chartPeriod === 'year'">Año</span>
            <h3>{{ getPorcentajeGastos() }}%</h3>
            <small>de tus ingresos</small>
          </div>
        </div>
        
        <!-- Mini tabla comparativa -->
        <div class="comparison-table">
          <div class="table-row header">
            <div></div>
            <div>Mes</div>
            <div>Año</div>
          </div>
          <div class="table-row">
            <div>Ingresos</div>
            <div>{{ totalIngresos | currency:'HNL':'L ' }}</div>
            <div>{{ anualIngresos | currency:'HNL':'L ' }}</div>
          </div>
          <div class="table-row">
            <div>Gastos</div>
            <div>{{ totalGastos | currency:'HNL':'L ' }}</div>
            <div>{{ anualGastos | currency:'HNL':'L ' }}</div>
          </div>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Últimas transacciones -->
  <ion-card class="transactions-card">
    <ion-card-header>
      <ion-card-title>Últimos Movimientos</ion-card-title>
    </ion-card-header>
    
    <ion-card-content>
      <ion-list lines="none">
        <ion-item *ngFor="let trans of ultimasTransacciones" class="transaction-item">
          <ion-icon 
            slot="start" 
            [name]="trans.tipo === 'ingreso' ? 'add-circle-outline' : 'remove-circle-outline'" 
            [color]="trans.tipo === 'ingreso' ? 'success' : 'danger'">
          </ion-icon>
          
          <ion-label>
            <h3>{{ trans.categoria }}</h3>
            <p>{{ trans.fecha | date:'mediumDate' }}</p>
          </ion-label>
          
          <ion-note slot="end" [color]="trans.tipo === 'ingreso' ? 'success' : 'danger'">
            {{ trans.monto | currency:'HNL':'L ' }}
          </ion-note>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>
</ion-content>